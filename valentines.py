# -*- coding: utf-8 -*-
"""Valentines.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1wUYaJATdlFzneSsaIqzVHGtsQHz7raV1
"""

import streamlit as st
import time

# -----------------------------
# Force Page Theme
# -----------------------------
st.set_page_config(
    page_title="Valentine ğŸ’–",
    layout="centered",
    initial_sidebar_state="collapsed"
)

# -----------------------------
# Session State
# -----------------------------
if "show_error" not in st.session_state:
    st.session_state.show_error = False

if "error_start" not in st.session_state:
    st.session_state.error_start = 0


# -----------------------------
# FORCE GLOBAL CSS (HARD OVERRIDE)
# -----------------------------
st.markdown(
    """
<style>

/* Kill Streamlit theme */
html, body, [class*="css"] {
    background-color: #ffb6c1 !important;
}

/* Main container */
section.main {
    background-color: #ffb6c1 !important;
}

/* App view */
div[data-testid="stAppViewContainer"] {
    background-color: #ffb6c1 !important;
}

/* Main block */
div[data-testid="stApp"] {
    background-color: #ffb6c1 !important;
}

/* Text */
h1, h2, h3, p, span {
    color: #fff3d6 !important;
}

/* Buttons */
div.stButton > button {
    width: 100%;
    height: 55px;
    font-size: 20px;
    border-radius: 12px;
}

/* Overlay */
#error-bg {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.4);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 999999;
}

/* Popup */
#error-box {
    background: white;
    padding: 35px;
    border-radius: 20px;
    width: 350px;
    text-align: center;
}

/* Popup text */
.error-black {
    color: black !important;
    font-weight: bold;
}

.error-normal {
    color: black !important;
}

</style>
""",
    unsafe_allow_html=True
)


# -----------------------------
# Title
# -----------------------------
st.markdown(
    "<h1 style='text-align:center;'>ğŸ’– Will You Be My Valentine? ğŸ’–</h1>",
    unsafe_allow_html=True
)


# -----------------------------
# Buttons
# -----------------------------
left, right = st.columns([1, 1])

with left:
    yes = st.button("ğŸ’˜ YES ğŸ’˜")

with right:
    no = st.button("ğŸ’” NO ğŸ’”")


# -----------------------------
# Button Logic
# -----------------------------
if yes:
    st.balloons()
    st.success("YAY!! ğŸ’• I knew you'd say yes ğŸ˜˜")

if no:
    st.session_state.show_error = True
    st.session_state.error_start = time.time()
    st.rerun()


# -----------------------------
# Popup
# -----------------------------
if st.session_state.show_error:

    elapsed = time.time() - st.session_state.error_start
    remaining = max(0, 5 - int(elapsed))

    if remaining == 0:
        st.session_state.show_error = False
        st.rerun()

    popup = f"""
    <div id="error-bg">
        <div id="error-box">

            <h2 class="error-black">âš ï¸ SYSTEM ERROR</h2>

            <p class="error-black">
                âŒ ERROR: You cannot choose that option.
            </p>

            <p class="error-normal">
                Please try again ğŸ’–<br><br>
                (Click anywhere to try again)
            </p>

            <p class="error-normal">
                Closing in {remaining}...
            </p>

        </div>
    </div>
    """

    st.markdown(popup, unsafe_allow_html=True)

    time.sleep(1)
    st.rerun()
# -*- coding: utf-8 -*-
"""Valentines.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1wUYaJATdlFzneSsaIqzVHGtsQHz7raV1
"""

import streamlit as st
import time

# -----------------------------
# Page Config
# -----------------------------
st.set_page_config(
    page_title="Valentine ğŸ’–",
    layout="centered"
)

# -----------------------------
# Session State
# -----------------------------
if "show_error" not in st.session_state:
    st.session_state.show_error = False

if "error_start_time" not in st.session_state:
    st.session_state.error_start_time = 0


# -----------------------------
# Global CSS
# -----------------------------
st.markdown(
    """
<style>

/* Background */
body {
    background-color: #ffb6c1 !important;
}

.main {
    background-color: #ffb6c1 !important;
}

/* Headings */
h1 {
    color: #fff3d6;
}

/* Button container */
div.stButton > button {
    width: 100%;
    height: 55px;
    font-size: 20px;
}

/* Overlay */
#error-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.45);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
}

/* Popup box */
#error-box {
    background: #ffc0cb;
    padding: 35px 40px;
    border-radius: 22px;
    width: 340px;
    text-align: center;
}

/* Cream text */
.cream {
    color: #fff3d6;
}

/* Black error */
.black {
    color: black;
    font-weight: bold;
}

</style>
""",
    unsafe_allow_html=True
)


# -----------------------------
# Title
# -----------------------------
st.markdown(
    "<h1 style='text-align:center;'>ğŸ’– Will You Be My Valentine? ğŸ’–</h1>",
    unsafe_allow_html=True
)


# -----------------------------
# Buttons
# -----------------------------
col1, col2 = st.columns([1, 1])

with col1:
    yes = st.button("ğŸ’˜ YES ğŸ’˜")

with col2:
    no = st.button("ğŸ’” NO ğŸ’”")


# -----------------------------
# Button Actions
# -----------------------------
if yes:
    st.balloons()
    st.success("YAY!! ğŸ’• I knew you'd say yes ğŸ˜˜")

if no:
    st.session_state.show_error = True
    st.session_state.error_start_time = time.time()
    st.rerun()


# -----------------------------
# Error Popup
# -----------------------------
if st.session_state.show_error:

    elapsed = time.time() - st.session_state.error_start_time
    remaining = max(0, 5 - int(elapsed))

    if remaining == 0:
        st.session_state.show_error = False
        st.rerun()

    popup_html = f"""
    <div id="error-overlay">
        <div id="error-box">

            <h2>âš ï¸ SYSTEM ERROR</h2>

            <p class="black">
                âŒ ERROR: You cannot choose that option.
            </p>

            <p class="cream">
                Please try again ğŸ’–<br><br>
                (Click anywhere to try again)
            </p>

            <p class="cream">
                Closing in {remaining}...
            </p>

        </div>
    </div>
    """

    st.markdown(popup_html, unsafe_allow_html=True)

    time.sleep(1)
    st.rerun()